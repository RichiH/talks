\documentclass[t]{beamer}
\usepackage{helvet}
\usepackage{calc}
\usepackage[utf8]{inputenc}
\usepackage[english]{babel}

\usetheme{Ilmenau}

\setbeamercovered{transparent}
\setbeamertemplate{navigation symbols}{}

\usepackage{units}
\usepackage{amsbsy}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{graphics}
\usepackage{graphicx}
\usepackage{epsf}
\usepackage{epsfig}
\usepackage{fixmath}
%\usepackage{pgfmath}
\usepackage{wrapfig}


\title{Adapting brownfield technology to cloud-native technology}
\subtitle{One year of Prometheus}
\author{Richard Hartmann,\\
RichiH@\{freenode,OFTC,IRCnet\},\\
richih@\{fosdem,debian,richih\}.org}
\date{2016-11-09}


\begin{document}

% hide all subsections
\setcounter{tocdepth}{1}

\begin{frame}
	\titlepage
\end{frame}

%\begin{frame}
%	\frametitle{Statistics}
%	\tableofcontents
%\end{frame}

\section{Introduction}

\begin{frame}
	\frametitle{`whoami`}
	\begin{itemize}
		\item Richard "RichiH" Hartmann
		\item System architect at SpaceNet AG
		\item FOSDEM, DebConf, DENOGx, PromCon staff
		\item Debian Developer
		\item Author of \url{https://github.com/RichiH/vcsh}
		\item Always looking for nice co-workers in the Munich area
	\end{itemize}
\end{frame}

\section{Background}

\begin{frame}
	\frametitle{`whowasi`}
	\begin{itemize}
		\item 2009-2015: Solely responsible for a Germany-wide backbone's
		\begin{itemize}
			\item Architecture
			\item Purchasing
			\item Operations
			\item ...and On-Call for 24 * 365 * 7 hours
		\end{itemize}
		\item Literally, my sanity depended on aggressive yet correct monitoring \& alerting
		\item Love monitoring, but hate (almost) all monitoring tools
		\item Used Zabbix exclusively
%TODO Keep that?		\item (New guy pushed Cacti and got approval; a good time to leave)
	\end{itemize}
\end{frame}

\begin{frame}
	\frametitle{SpaceNet}
	\begin{itemize}
		\item SpaceNet is the oldest commercial ISP in Germany; operating since 1993
		\item Legacy, in-house solutions which predate everything else
		\item One company-wide monitoring solution: watchdog \& watchcat
		\item Technically sound, but alerting done through B52-style email carpet bombing
		\item Every team has its own custom tools on top
		\item Islands of data; no APIs, no machine-readable export
%%		\item Quality dependent on team
%Not invented here
%  Anyone can Design Encryption they CAN'T Break; or Monitoring they CAN'T improve any more
	\end{itemize}
\end{frame}


% money is made with brownfield so you need to make sure there is no impact
  % lots of overlap until new stuff gains trust
  % people's motivation is to resist change; and that's OK until the system can actually handle change
  % most will readily agree that the new approach is better, but they fear the way there
    % ideally, we should magic from zero to done without anyone noticing


% 

\section{Lightbringer}

\begin{frame}
	\frametitle{Seeing the light}
	\begin{itemize}
		\item Ran DebConf15 on LibreNMS, wanted to do the same for FOSDEM
		\item 2015-10-01: Inform FOSDEM team of planned migration
		\item 2015-10-02: Murali Suriar suggests Prometheus instead
		\item 2015-10-03: Run local test and submit first trivial patch
	\end{itemize}
\end{frame}

\subsection{Technical challenges}

\begin{frame}
	\frametitle{Here, there be networks}
	\begin{itemize}
		\item We are an ISP, remember?
		\item Roughly 1000 devices polled via SNMP
		\item Might be the world's largest snmp\_exporter installation
		\item Python implementation at pathologic system load
		\begin{itemize}
			\item It goes up to eleven...
			\item About 60/300 devices flapping
			\item Set of affected devices stable
		\end{itemize}
	\end{itemize}
\end{frame}

\begin{frame}
	\frametitle{Solution}
	\begin{itemize}
		\item Contracted Brian Brazil to reimplement in Go
		\item Go implementation hit some unexpected pitfalls of real life SNMP
		\begin{itemize}
			\item Some data structures returned repeatedly
			\item Duplicate identifiers
			\item Table indices emtpy
		\end{itemize}
		\item Go implementation errors out completely, still using Python for some devices
	\end{itemize}
\end{frame}

\begin{frame}
	\frametitle{Caveats}
	\begin{itemize}
		\item InetAddress broken in Python
		\item IOS XR non-standard layout not fully supported yet 
		\item Some devices die when polled too often
		\item and we're done?
	\end{itemize}
\end{frame}


\subsection{Operational}

\begin{frame}
	\frametitle{The biggest challenge}
	\begin{itemize}
%Toil in too many places
		\item %TODO
	\end{itemize}
\end{frame}

\subsection{Money}

\begin{frame}
	\frametitle{The biggest challenge}
	\begin{itemize}
		\item In brownfield, revenue comes from legacy systems
		\item 
	\end{itemize}
\end{frame}

\subsection{Social Challenges}

\begin{frame}
	\frametitle{Resistance to change}
	\begin{itemize}
		\item Incentives often run counter to change
		\item Change is hard
		\item Unless your processes embrace, and automate, change
		\item Trade-off between delayed, or disputed, payoff during transistion
		\item Critical systems maintained in parallel
%Too much work to install agent as no central role-out(wollen wir das?)
% operations stakeholders fear change
  % they get paid to keep the current system up and running, not to increase change
  % yes, yes, error budgets
	\end{itemize}
\end{frame}

\begin{frame}
	\frametitle{That one mailserver incident...}
	\begin{itemize}
		\item Wrong flag in config
		\item One server accepting outside mail
		\item Spammers do a clean, staggered ramp-up
		\item Once they go all-in the mail gateways come under heavy load
		\item Quote from On-Call "It took me less than 30 seconds to figure out the problem; with our old system it would have taken 5-15 minutes"
		\item ...and all of a sudden, you have buy-in from a few more people
	\end{itemize}
\end{frame}

\begin{frame}
	\frametitle{Perspective}
	\begin{itemize}
		\item Tell everyone what they need to hear (but never lie)
		\item Managers care about revenue and smooth process execution
		\item Architects care about clean design and smooth process defintions
		\item Team leads care about keeping people motivated
		\item Operators care about reducing workload
		\item "An engineer loves to talk for hours about a specific UPS model; try that with the CEO"
%Big Picture for management, button from top, middle management and key technical architects
%  Different parts of the picture for different people and languages
%  Anyone can talk to an engineer about a UPS for two hours, but management...
% sales
% accounting
% power count
	\end{itemize}
\end{frame}


\begin{frame}
	\frametitle{Give them what they want}
	\begin{itemize}
		\item 
%Autogen PDF reports
%One tool fits all departments
%  Buy-in from service management
%Give them what they want/play to their intrinsic motivation
%%%%% dopplung zu persepcitve!
% sales
% accounting
% power count
%%%%%
	\end{itemize}
\end{frame}

%ToDo / The future
%Error budgets as a long-term goal


% social (windows)
%If no motivation, escalate


% are we there yet? no!
% highly fractured, remember? Still, kubernetes operators sound extremely nice
% finding the correct balance can be tricky

%Know of UPS / core link downtime within less than 30 seconds, but no false positives
%Want USV in seconds, Mail Accounting reicht täglich

%Goals / that's obvious section?

%Current state NOW, not five minutes ago (but info)
%Important later, during daytime
%Make sure tickets are opened so we can postmortem all the things

%Push vs pull not a conceptual problem due to watchdog
%  Concept of scraping new
%Watchdog can do logic checks, regexp etc; not only metrics
%

%Wollen ewiges Storage
%Immer noch zwei große Prom, Teams noch nicht so weit.

%Too much "fix this now" and not learning aggressively from outages.
%Not all teams tracked and compared KPIs over time
%From plain uptime to service request success rate

%Dashboard
%Perpetual greenfield
%One tool fits all
%Make your hammer fit your nails


\section{Outro}

\begin{frame}
	\frametitle{Thanks!}
		\begin{center}
			\vfill
			Thanks for listening!\\
			\vfill
			Questions?
			\vfill
			See slide footer for contact information.
			\vfill
		\end{center}
\end{frame}

\end{document}

%\begin{frame}
%	\frametitle{}
%	\begin{itemize}
%		\item 
%		\item 
%		\item 
%		\item 
%		\item 
%	\end{itemize}
%\end{frame}
